<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Zoom with Drawing</title>
    <style>
        canvas {
            border: 1px solid black;
            touch-action: none; /* Disable default touch gestures */
        }
        #colors {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <canvas id="myCanvas" width="400" height="400"></canvas>
    <div id="colors">
        <input type="color" id="colorPicker">
        <button onclick="erase()">Erase</button>
        <button onclick="undo()">Undo</button>
        <button onclick="redo()">Redo</button>
        <button onclick="save()">Save</button>
    </div>

    <script>
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');
        const colorPicker = document.getElementById('colorPicker');
        let scale = 1;
        let history = [];
        let future = [];

        // Initial draw
        draw();

        // Function to draw something on the canvas
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = 'red';
            ctx.fillRect(100 * scale, 100 * scale, 100 * scale, 100 * scale);
            history.push(ctx.getImageData(0, 0, canvas.width, canvas.height));
        }

        // Pinch to zoom
        let lastDistance = 0;

        canvas.addEventListener('touchstart', function (e) {
            if (e.touches.length === 2) {
                lastDistance = getPinchDistance(e.touches[0], e.touches[1]);
            }
        });

        canvas.addEventListener('touchmove', function (e) {
            if (e.touches.length === 2) {
                const distance = getPinchDistance(e.touches[0], e.touches[1]);
                const delta = distance - lastDistance;
                const sensitivity = 0.01; // Adjust sensitivity as needed

                scale += delta * sensitivity;
                scale = Math.max(0.1, scale); // Prevent zooming out too much

                draw();
                lastDistance = distance;
            }
        });

        function getPinchDistance(touch1, touch2) {
            const dx = touch2.clientX - touch1.clientX;
            const dy = touch2.clientY - touch1.clientY;
            return Math.sqrt(dx * dx + dy * dy);
        }

        // Erase function
        function erase() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Undo function
        function undo() {
            if (history.length > 1) {
                future.push(history.pop());
                ctx.putImageData(history[history.length - 1], 0, 0);
            }
        }

        // Redo function
        function redo() {
            if (future.length > 0) {
                history.push(future.pop());
                ctx.putImageData(history[history.length - 1], 0, 0);
            }
        }

        // Save function
        function save() {
            const dataURL = canvas.toDataURL();
            const a = document.createElement('a');
            a.href = dataURL;
            a.download = 'canvas_image.png';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html>
